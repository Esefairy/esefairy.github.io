<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
        body,
        html {
            width: 100%;
            height: 100%;
            margin: 0;
            font-family: "微软雅黑";
        }

        #l-map {
            height: 300px;
            width: 100%;
        }

        #r-result {
            width: 100%;
            font-size: 14px;
            line-height: 20px;
        }
    </style>
    <script type="text/javascript" src="//api.map.baidu.com/api?v=2.0&ak=Tu3sl1OghDen0X5aCF8t32YqbIrigLq5"></script>
    <title>公交换乘</title>
</head>

<body>
    <div id="l-map"></div>
    起点&nbsp;:&nbsp;<input type="text" size="22" id="start">
    终点&nbsp;:&nbsp;<input type="text" size="22" id="end">
    <br />
    <input type="button" value="查询" onclick="search()">

    <div id="r-result"></div>
</body>

</html>
<script type="text/javascript">
    // 百度地图API功能
    var map = new BMap.Map("l-map");
    map.centerAndZoom(new BMap.Point(119.9129283,32.4523481), 10);
    map.enableScrollWheelZoom();

    var transit = new BMap.TransitRoute(map, {
        renderOptions: { map: map }, onSearchComplete: function (result) {
            if (transit.getStatus() == BMAP_STATUS_SUCCESS) {
                var firstPlan = result.getPlan(0);
                // 绘制步行线路
                for (var i = 0; i < firstPlan.getNumRoutes(); i++) {
                    var walk = firstPlan.getRoute(i);
                    if (walk.getDistance(false) > 0) {
                        // 步行线路有可能为0
                        map.addOverlay(new BMap.Polyline(walk.getPath(), { lineColor: "green" }));
                    }
                }
                // 绘制公交线路
                for (i = 0; i < firstPlan.getNumLines(); i++) {
                    var line = firstPlan.getLine(i);
                    map.addOverlay(new BMap.Polyline(line.getPath()));
                }
                // 输出方案信息
                var s = [];
                for (i = 0; i < result.getNumPlans(); i++) {
                    s.push((i + 1) + ". " + result.getPlan(i).getDescription(false));
                }
                 document.getElementById("r-result").innerHTML = "路线规划如下:<br/><br/>" + "共有" + result.getNumPlans() + "条线路<br/><br/>" + s.join("<br/>");
            }
        }
    });
    var start = document.getElementById("start");
    var end = document.getElementById("end");
    function search() {
        transit.search(start.value, end.value);
    }
</script>